//nt comes in charge on the bunch fillling scheme page (source Ekaterina)

#include "TAxis.h"
#include "TCanvas.h"
#include "TF1.h"
#include "TFile.h"
#include "TFitResult.h"
#include "TFitResultPtr.h"
#include "TGraph.h"
#include "TGraphErrors.h"
#include "TH1D.h"
#include "TH2D.h"
#include "TLegend.h"
#include "TLine.h"
#include "TMarker.h"
#include "TMath.h"
#include "TROOT.h"
#include "TVectorD.h"

#ifndef __CINT__
#include "style.h"
#endif

#include <iomanip>
#include <iostream>
#include <sstream>
#include <utility>

void makePlots_vdm_beambeam1()
{

  gROOT->ProcessLine(" .L style.cc+");
#ifdef __CINT__
  style();
#endif

  const double ep = 1380;
  const double epb = 4000;
  const double mp = 0.938;
  const double gamma = ep / mp;
  const double gammapb = epb / mp;

  TCanvas* c1 = new TCanvas;
  TF1 *f = new TF1 ("f", "-2*[0]*[1]/[2] * ((1.-exp(-x*x/(2.*[3]*[3])))/x)", -400., 400.);
  f->SetParName(0,"re"); f->SetParameter( 0, 1.53e-12); //µm
  f->SetParName(1,"nt"); f->SetParameter( 1, 8.5e10);
  f->SetParName(2,"gamma"); f->SetParameter( 2, gamma);
  f->SetParName(3,"sigma"); f->SetParameter( 3, 125.);
  f->Draw();
  
  /////////////////////

  TCanvas* c2 = new TCanvas;
  TString formula("-1*-2*[0]*[1]/[2] * ((1.-exp(-x*x/(2.*[3]*[3])))/x) * [4] / (2.*tan(TMath::Pi()*[6]))");
  //TString formula("-1*-2*[0]*[1]/[2] * ((1.-exp(-x*x/(2.*[3]*[3])))/x)*1000");
  TF1 *f1 = new TF1 ("f1", formula, -500., 500.);
  TF1 *fp = new TF1 ("fp", formula, -500., 500.);
  TF1 *fpb = new TF1 ("fpb", formula, -500., 500.);
  TLegend* leg = new TLegend(0.25,0.75,0.55,0.9);
  fp->SetNpx(500);
  fp->SetTitle(";#DeltaX [#mum];<deflection> [#mum]");
  fp->SetMaximum(1);
  fp->SetMinimum(-1);

  f1->SetParName(0,"re"); f1->SetParameter( 0, 1.53e-12); //µm
  f1->SetParName(1,"nt"); f1->SetParameter( 1, 10e10);
  f1->SetParName(2,"gamma"); f1->SetParameter( 2, gamma);
  f1->SetParName(3,"sigma"); f1->SetParameter( 3, 150.);
  f1->SetParName(4,"betastar"); f1->SetParameter( 4, 11e6);
  f1->SetParName(5,"tunex"); f1->SetParameter( 5, 64.31);
  f1->SetParName(6,"tuney"); f1->SetParameter( 6, 59.32);
  f1->SetMaximum(4);
  f1->SetMinimum(-2.8);
  f1->GetXaxis()->SetNdivisions(505);
  f1->SetTitle(";#DeltaX [#mum];<deflection> [#mum]");
  f1->SetLineWidth(2); f1->SetLineColor(kBlack); f1->Draw();
  f1->GetXaxis()->SetNdivisions(505);
  leg->AddEntry(f1,"pp p@2.76TeV (#sigma=150#mum, N=10e10)","l");

  TF1 *f2 = new TF1 ("f2", formula, -500., 500.);
  f2->SetParName(0,"re"); f2->SetParameter( 0, 1.53e-12); //µm
  f2->SetParName(1,"nt"); f2->SetParameter( 1, 8.5e10);
  f2->SetParName(2,"gamma"); f2->SetParameter( 2, gammapb);
  f2->SetParName(3,"sigma"); f2->SetParameter( 3, 125.);
  f2->SetParName(4,"betastar"); f2->SetParameter( 4, 11e6);
  f2->SetParName(5,"tunex"); f2->SetParameter( 5, 64.31);
  f2->SetParName(6,"tuney"); f2->SetParameter( 6, 59.32);
  f2->SetLineWidth(2); f2->SetLineColor(kRed); f2->Draw("SAME");
  leg->AddEntry(f2,"pp p@8TeV (#sigma=125#mum, N=8.5e10)","l");

  fp->SetParName(0,"re"); fp->SetParameter( 0, 1.53e-12); //µm
  fp->SetParName(1,"nt"); fp->SetParameter( 1, 6.5e9); //!!!this is intensity of target beam (i.e. lead)
  fp->SetParName(2,"gamma"); fp->SetParameter( 2, gammapb); 
  fp->SetParName(3,"sigma"); fp->SetParameter( 3, 35.);
  fp->SetParName(4,"betastar"); fp->SetParameter( 4, 0.8e6);
  fp->SetParName(5,"tunex"); fp->SetParameter( 5, 64.31);
  fp->SetParName(6,"tuney"); fp->SetParameter( 6, 59.32);
  fp->SetLineWidth(2); fp->SetLineColor(kRed); fp->Draw("SAME");
  leg->AddEntry(fp,"pPb p@4TeV (#sigma=35#mum)","l");

  fpb->SetParName(0,"re"); fpb->SetParameter( 0, 1.53e-12); //µm
  fpb->SetParName(1,"nt"); fpb->SetParameter( 1, 1.26e10); //!!!this is intensity of target beam (i.e. proton)
  fpb->SetParName(2,"gamma"); fpb->SetParameter( 2, gammapb);
  fpb->SetParName(3,"sigma"); fpb->SetParameter( 3, 35.);
  fpb->SetParName(4,"betastar"); fpb->SetParameter( 4, 0.8e6);
  fpb->SetParName(5,"tunex"); fpb->SetParameter( 5, 64.31);
  fpb->SetParName(6,"tuney"); fpb->SetParameter( 6, 59.32);
  //fpb->SetLineWidth(2); fpb->SetLineColor(kBlue); fpb->Draw("SAME");
  fpb->GetYaxis()->SetLimits(-0.6,0.6);
  //leg->AddEntry(fpb,"pPb Pb@1.58TeV (#sigma=35#mum)","l");

#ifdef __CINT__
  SetLegAtt(leg);
#endif
  leg->Draw("SAME");
  c2->SaveAs((string("plots/vdm_beambeam_1.pdf")).c_str());

  /////////////////////

  TF1 *f2 = new TF1 ("f2", "(1.-exp(-x*x/(2.*[0]*[0])))/x", -1000., 1000.);
  f2->SetParName(0,"sigma"); f2->SetParameter( 0, 125);
  cout
    << f2->Eval(10) << endl
    << f2->Eval(100) << endl
    << f2->Eval(200) << endl
    << f2->Eval(500) << endl
    << f2->Eval(1000) << endl
    << f2->Eval(-1000) << endl
    << "gamma = " << gamma << endl
    << "gammapb = " << gammapb << endl
    << "factor = " << -2.*2.8179403267e-9*8.5e10/gamma << endl
    ;
  
  TH1D* h_p = new TH1D("h_p","proton;N_{ch} [10^{10}];N_{b}",30,0.7,1.8);
  TH1D* h_pb = new TH1D("h_pb","proton;N_{ch} [10^{10}];N_{b}",30,0.7,1.8);

  h_p->Fill(0.960);
  h_p->Fill(0.997);
  h_p->Fill(1.001);
  h_p->Fill(1.012);
  h_p->Fill(1.014);
  h_p->Fill(1.016);
  h_p->Fill(1.016);
  h_p->Fill(1.020);
  h_p->Fill(1.023);
  h_p->Fill(1.027);
  h_p->Fill(1.037);
  h_p->Fill(1.038);
  h_p->Fill(1.045);
  h_p->Fill(1.046);
  h_p->Fill(1.059);
  h_p->Fill(1.061);
  h_p->Fill(1.064);
  h_p->Fill(1.064);
  h_p->Fill(1.064);
  h_p->Fill(1.068);
  h_p->Fill(1.068);
  h_p->Fill(1.072);
  h_p->Fill(1.073);
  h_p->Fill(1.076);
  h_p->Fill(1.076);
  h_p->Fill(1.077);
  h_p->Fill(1.078);
  h_p->Fill(1.080);
  h_p->Fill(1.080);
  h_p->Fill(1.084);
  h_p->Fill(1.085);
  h_p->Fill(1.086);
  h_p->Fill(1.094);
  h_p->Fill(1.094);
  h_p->Fill(1.096);
  h_p->Fill(1.097);
  h_p->Fill(1.100);
  h_p->Fill(1.104);
  h_p->Fill(1.104);
  h_p->Fill(1.106);
  h_p->Fill(1.108);
  h_p->Fill(1.110);
  h_p->Fill(1.113);
  h_p->Fill(1.113);
  h_p->Fill(1.115);
  h_p->Fill(1.118);
  h_p->Fill(1.123);
  h_p->Fill(1.132);
  h_p->Fill(1.137);
  h_p->Fill(1.138);
  h_p->Fill(1.139);
  h_p->Fill(1.141);
  h_p->Fill(1.141);
  h_p->Fill(1.142);
  h_p->Fill(1.142);
  h_p->Fill(1.144);
  h_p->Fill(1.144);
  h_p->Fill(1.145);
  h_p->Fill(1.149);
  h_p->Fill(1.151);
  h_p->Fill(1.151);
  h_p->Fill(1.155);
  h_p->Fill(1.156);
  h_p->Fill(1.157);
  h_p->Fill(1.160);
  h_p->Fill(1.161);
  h_p->Fill(1.161);
  h_p->Fill(1.162);
  h_p->Fill(1.162);
  h_p->Fill(1.165);
  h_p->Fill(1.170);
  h_p->Fill(1.172);
  h_p->Fill(1.173);
  h_p->Fill(1.173);
  h_p->Fill(1.175);
  h_p->Fill(1.178);
  h_p->Fill(1.178);
  h_p->Fill(1.186);
  h_p->Fill(1.189);
  h_p->Fill(1.191);
  h_p->Fill(1.191);
  h_p->Fill(1.192);
  h_p->Fill(1.192);
  h_p->Fill(1.194);
  h_p->Fill(1.195);
  h_p->Fill(1.196);
  h_p->Fill(1.196);
  h_p->Fill(1.200);
  h_p->Fill(1.201);
  h_p->Fill(1.202);
  h_p->Fill(1.203);
  h_p->Fill(1.207);
  h_p->Fill(1.209);
  h_p->Fill(1.209);
  h_p->Fill(1.211);
  h_p->Fill(1.211);
  h_p->Fill(1.212);
  h_p->Fill(1.213);
  h_p->Fill(1.215);
  h_p->Fill(1.216);
  h_p->Fill(1.216);
  h_p->Fill(1.217);
  h_p->Fill(1.223);
  h_p->Fill(1.223);
  h_p->Fill(1.224);
  h_p->Fill(1.224);
  h_p->Fill(1.225);
  h_p->Fill(1.225);
  h_p->Fill(1.225);
  h_p->Fill(1.226);
  h_p->Fill(1.226);
  h_p->Fill(1.227);
  h_p->Fill(1.228);
  h_p->Fill(1.229);
  h_p->Fill(1.231);
  h_p->Fill(1.232);
  h_p->Fill(1.233);
  h_p->Fill(1.236);
  h_p->Fill(1.238);
  h_p->Fill(1.238);
  h_p->Fill(1.240);
  h_p->Fill(1.240);
  h_p->Fill(1.243);
  h_p->Fill(1.247);
  h_p->Fill(1.247);
  h_p->Fill(1.247);
  h_p->Fill(1.251);
  h_p->Fill(1.252);
  h_p->Fill(1.253);
  h_p->Fill(1.255);
  h_p->Fill(1.256);
  h_p->Fill(1.256);
  h_p->Fill(1.257);
  h_p->Fill(1.258);
  h_p->Fill(1.258);
  h_p->Fill(1.258);
  h_p->Fill(1.260);
  h_p->Fill(1.261);
  h_p->Fill(1.261);
  h_p->Fill(1.262);
  h_p->Fill(1.262);
  h_p->Fill(1.262);
  h_p->Fill(1.263);
  h_p->Fill(1.266);
  h_p->Fill(1.266);
  h_p->Fill(1.268);
  h_p->Fill(1.268);
  h_p->Fill(1.272);
  h_p->Fill(1.272);
  h_p->Fill(1.273);
  h_p->Fill(1.275);
  h_p->Fill(1.278);
  h_p->Fill(1.280);
  h_p->Fill(1.281);
  h_p->Fill(1.282);
  h_p->Fill(1.282);
  h_p->Fill(1.285);
  h_p->Fill(1.286);
  h_p->Fill(1.289);
  h_p->Fill(1.290);
  h_p->Fill(1.293);
  h_p->Fill(1.293);
  h_p->Fill(1.295);
  h_p->Fill(1.296);
  h_p->Fill(1.298);
  h_p->Fill(1.298);
  h_p->Fill(1.299);
  h_p->Fill(1.299);
  h_p->Fill(1.299);
  h_p->Fill(1.299);
  h_p->Fill(1.301);
  h_p->Fill(1.303);
  h_p->Fill(1.304);
  h_p->Fill(1.304);
  h_p->Fill(1.305);
  h_p->Fill(1.306);
  h_p->Fill(1.306);
  h_p->Fill(1.310);
  h_p->Fill(1.312);
  h_p->Fill(1.313);
  h_p->Fill(1.314);
  h_p->Fill(1.316);
  h_p->Fill(1.317);
  h_p->Fill(1.319);
  h_p->Fill(1.319);
  h_p->Fill(1.319);
  h_p->Fill(1.320);
  h_p->Fill(1.321);
  h_p->Fill(1.321);
  h_p->Fill(1.324);
  h_p->Fill(1.327);
  h_p->Fill(1.329);
  h_p->Fill(1.329);
  h_p->Fill(1.331);
  h_p->Fill(1.331);
  h_p->Fill(1.332);
  h_p->Fill(1.333);
  h_p->Fill(1.334);
  h_p->Fill(1.335);
  h_p->Fill(1.335);
  h_p->Fill(1.340);
  h_p->Fill(1.340);
  h_p->Fill(1.342);
  h_p->Fill(1.342);
  h_p->Fill(1.343);
  h_p->Fill(1.344);
  h_p->Fill(1.348);
  h_p->Fill(1.348);
  h_p->Fill(1.349);
  h_p->Fill(1.350);
  h_p->Fill(1.352);
  h_p->Fill(1.352);
  h_p->Fill(1.352);
  h_p->Fill(1.354);
  h_p->Fill(1.354);
  h_p->Fill(1.355);
  h_p->Fill(1.356);
  h_p->Fill(1.357);
  h_p->Fill(1.357);
  h_p->Fill(1.359);
  h_p->Fill(1.361);
  h_p->Fill(1.363);
  h_p->Fill(1.363);
  h_p->Fill(1.364);
  h_p->Fill(1.364);
  h_p->Fill(1.365);
  h_p->Fill(1.365);
  h_p->Fill(1.367);
  h_p->Fill(1.368);
  h_p->Fill(1.369);
  h_p->Fill(1.370);
  h_p->Fill(1.371);
  h_p->Fill(1.372);
  h_p->Fill(1.372);
  h_p->Fill(1.373);
  h_p->Fill(1.373);
  h_p->Fill(1.377);
  h_p->Fill(1.379);
  h_p->Fill(1.382);
  h_p->Fill(1.394);
  h_p->Fill(1.395);
  h_p->Fill(1.396);
  h_p->Fill(1.400);
  h_p->Fill(1.403);
  h_p->Fill(1.404);
  h_p->Fill(1.405);
  h_p->Fill(1.415);
  h_p->Fill(1.417);
  h_p->Fill(1.425);
  h_p->Fill(1.425);
  h_p->Fill(1.434);
  h_p->Fill(1.440);
  h_p->Fill(1.444);
  h_p->Fill(1.453);
  h_p->Fill(1.481);
  h_p->Fill(1.490);
  h_p->Fill(1.494);
  h_p->Fill(1.499);
  h_p->Fill(1.504);
  h_p->Fill(1.523);
  h_p->Fill(1.523);
  h_p->Fill(1.524);
  h_p->Fill(1.524);
  h_p->Fill(1.546);
  h_p->Fill(1.566);
  h_p->Fill(1.576);
  h_p->Fill(1.591);
  h_p->Fill(1.595);
  h_p->Fill(1.598);
  h_p->Fill(1.600);
  h_p->Fill(1.616);
  h_p->Fill(1.630); 

  h_pb->Fill(0.827);
  h_pb->Fill(0.852);
  h_pb->Fill(0.857);
  h_pb->Fill(0.864);
  h_pb->Fill(0.869);
  h_pb->Fill(0.872);
  h_pb->Fill(0.877);
  h_pb->Fill(0.882);
  h_pb->Fill(0.882);
  h_pb->Fill(0.883);
  h_pb->Fill(0.884);
  h_pb->Fill(0.890);
  h_pb->Fill(0.894);
  h_pb->Fill(0.896);
  h_pb->Fill(0.897);
  h_pb->Fill(0.901);
  h_pb->Fill(0.901);
  h_pb->Fill(0.903);
  h_pb->Fill(0.906);
  h_pb->Fill(0.907);
  h_pb->Fill(0.908);
  h_pb->Fill(0.910);
  h_pb->Fill(0.914);
  h_pb->Fill(0.917);
  h_pb->Fill(0.918);
  h_pb->Fill(0.918);
  h_pb->Fill(0.919);
  h_pb->Fill(0.921);
  h_pb->Fill(0.922);
  h_pb->Fill(0.923);
  h_pb->Fill(0.925);
  h_pb->Fill(0.926);
  h_pb->Fill(0.926);
  h_pb->Fill(0.926);
  h_pb->Fill(0.926);
  h_pb->Fill(0.927);
  h_pb->Fill(0.927);
  h_pb->Fill(0.927);
  h_pb->Fill(0.927);
  h_pb->Fill(0.930);
  h_pb->Fill(0.931);
  h_pb->Fill(0.932);
  h_pb->Fill(0.932);
  h_pb->Fill(0.932);
  h_pb->Fill(0.934);
  h_pb->Fill(0.935);
  h_pb->Fill(0.937);
  h_pb->Fill(0.939);
  h_pb->Fill(0.939);
  h_pb->Fill(0.940);
  h_pb->Fill(0.944);
  h_pb->Fill(0.944);
  h_pb->Fill(0.944);
  h_pb->Fill(0.945);
  h_pb->Fill(0.946);
  h_pb->Fill(0.947);
  h_pb->Fill(0.948);
  h_pb->Fill(0.949);
  h_pb->Fill(0.949);
  h_pb->Fill(0.950);
  h_pb->Fill(0.954);
  h_pb->Fill(0.954);
  h_pb->Fill(0.956);
  h_pb->Fill(0.957);
  h_pb->Fill(0.959);
  h_pb->Fill(0.960);
  h_pb->Fill(0.960);
  h_pb->Fill(0.960);
  h_pb->Fill(0.963);
  h_pb->Fill(0.964);
  h_pb->Fill(0.965);
  h_pb->Fill(0.965);
  h_pb->Fill(0.968);
  h_pb->Fill(0.969);
  h_pb->Fill(0.970);
  h_pb->Fill(0.970);
  h_pb->Fill(0.970);
  h_pb->Fill(0.972);
  h_pb->Fill(0.972);
  h_pb->Fill(0.973);
  h_pb->Fill(0.974);
  h_pb->Fill(0.974);
  h_pb->Fill(0.975);
  h_pb->Fill(0.980);
  h_pb->Fill(0.980);
  h_pb->Fill(0.981);
  h_pb->Fill(0.982);
  h_pb->Fill(0.983);
  h_pb->Fill(0.985);
  h_pb->Fill(0.986);
  h_pb->Fill(0.986);
  h_pb->Fill(0.990);
  h_pb->Fill(0.991);
  h_pb->Fill(0.991);
  h_pb->Fill(0.991);
  h_pb->Fill(0.994);
  h_pb->Fill(0.995);
  h_pb->Fill(0.998);
  h_pb->Fill(1.002);
  h_pb->Fill(1.002);
  h_pb->Fill(1.003);
  h_pb->Fill(1.003);
  h_pb->Fill(1.004);
  h_pb->Fill(1.007);
  h_pb->Fill(1.008);
  h_pb->Fill(1.009);
  h_pb->Fill(1.010);
  h_pb->Fill(1.011);
  h_pb->Fill(1.011);
  h_pb->Fill(1.012);
  h_pb->Fill(1.016);
  h_pb->Fill(1.018);
  h_pb->Fill(1.019);
  h_pb->Fill(1.023);
  h_pb->Fill(1.025);
  h_pb->Fill(1.026);
  h_pb->Fill(1.026);
  h_pb->Fill(1.030);
  h_pb->Fill(1.032);
  h_pb->Fill(1.034);
  h_pb->Fill(1.035);
  h_pb->Fill(1.036);
  h_pb->Fill(1.037);
  h_pb->Fill(1.038);
  h_pb->Fill(1.038);
  h_pb->Fill(1.039);
  h_pb->Fill(1.040);
  h_pb->Fill(1.043);
  h_pb->Fill(1.043);
  h_pb->Fill(1.043);
  h_pb->Fill(1.044);
  h_pb->Fill(1.044);
  h_pb->Fill(1.045);
  h_pb->Fill(1.047);
  h_pb->Fill(1.049);
  h_pb->Fill(1.049);
  h_pb->Fill(1.058);
  h_pb->Fill(1.060);
  h_pb->Fill(1.061);
  h_pb->Fill(1.061);
  h_pb->Fill(1.062);
  h_pb->Fill(1.062);
  h_pb->Fill(1.063);
  h_pb->Fill(1.069);
  h_pb->Fill(1.069);
  h_pb->Fill(1.072);
  h_pb->Fill(1.072);
  h_pb->Fill(1.076);
  h_pb->Fill(1.076);
  h_pb->Fill(1.078);
  h_pb->Fill(1.078);
  h_pb->Fill(1.079);
  h_pb->Fill(1.080);
  h_pb->Fill(1.082);
  h_pb->Fill(1.085);
  h_pb->Fill(1.086);
  h_pb->Fill(1.090);
  h_pb->Fill(1.093);
  h_pb->Fill(1.096);
  h_pb->Fill(1.101);
  h_pb->Fill(1.101);
  h_pb->Fill(1.103);
  h_pb->Fill(1.110);
  h_pb->Fill(1.111);
  h_pb->Fill(1.113);
  h_pb->Fill(1.115);
  h_pb->Fill(1.115);
  h_pb->Fill(1.116);
  h_pb->Fill(1.117);
  h_pb->Fill(1.119);
  h_pb->Fill(1.121);
  h_pb->Fill(1.124);
  h_pb->Fill(1.131);
  h_pb->Fill(1.132);
  h_pb->Fill(1.133);
  h_pb->Fill(1.134);
  h_pb->Fill(1.136);
  h_pb->Fill(1.139);
  h_pb->Fill(1.146);
  h_pb->Fill(1.148);
  h_pb->Fill(1.149);
  h_pb->Fill(1.149);
  h_pb->Fill(1.153);
  h_pb->Fill(1.156);
  h_pb->Fill(1.157);
  h_pb->Fill(1.158);
  h_pb->Fill(1.158);
  h_pb->Fill(1.160);
  h_pb->Fill(1.163);
  h_pb->Fill(1.169);
  h_pb->Fill(1.170);
  h_pb->Fill(1.171);
  h_pb->Fill(1.172);
  h_pb->Fill(1.173);
  h_pb->Fill(1.174);
  h_pb->Fill(1.174);
  h_pb->Fill(1.174);
  h_pb->Fill(1.186);
  h_pb->Fill(1.188);
  h_pb->Fill(1.195);
  h_pb->Fill(1.197);
  h_pb->Fill(1.197);
  h_pb->Fill(1.198);
  h_pb->Fill(1.200);
  h_pb->Fill(1.201);
  h_pb->Fill(1.205);
  h_pb->Fill(1.209);
  h_pb->Fill(1.211);
  h_pb->Fill(1.213);
  h_pb->Fill(1.214);
  h_pb->Fill(1.217);
  h_pb->Fill(1.218);
  h_pb->Fill(1.219);
  h_pb->Fill(1.220);
  h_pb->Fill(1.222);
  h_pb->Fill(1.224);
  h_pb->Fill(1.224);
  h_pb->Fill(1.230);
  h_pb->Fill(1.239);
  h_pb->Fill(1.240);
  h_pb->Fill(1.242);
  h_pb->Fill(1.244);
  h_pb->Fill(1.252);
  h_pb->Fill(1.253);
  h_pb->Fill(1.256);
  h_pb->Fill(1.257);
  h_pb->Fill(1.262);
  h_pb->Fill(1.262);
  h_pb->Fill(1.265);
  h_pb->Fill(1.265);
  h_pb->Fill(1.267);
  h_pb->Fill(1.268);
  h_pb->Fill(1.273);
  h_pb->Fill(1.274);
  h_pb->Fill(1.275);
  h_pb->Fill(1.284);
  h_pb->Fill(1.284);
  h_pb->Fill(1.294);
  h_pb->Fill(1.295);
  h_pb->Fill(1.296);
  h_pb->Fill(1.302);
  h_pb->Fill(1.305);
  h_pb->Fill(1.305);
  h_pb->Fill(1.311);
  h_pb->Fill(1.312);
  h_pb->Fill(1.313);
  h_pb->Fill(1.313);
  h_pb->Fill(1.315);
  h_pb->Fill(1.320);
  h_pb->Fill(1.320);
  h_pb->Fill(1.324);
  h_pb->Fill(1.326);
  h_pb->Fill(1.327);
  h_pb->Fill(1.328);
  h_pb->Fill(1.334);
  h_pb->Fill(1.336);
  h_pb->Fill(1.337);
  h_pb->Fill(1.337);
  h_pb->Fill(1.339);
  h_pb->Fill(1.343);
  h_pb->Fill(1.343);
  h_pb->Fill(1.345);
  h_pb->Fill(1.351);
  h_pb->Fill(1.354);
  h_pb->Fill(1.354);
  h_pb->Fill(1.358);
  h_pb->Fill(1.360);
  h_pb->Fill(1.371);
  h_pb->Fill(1.371);
  h_pb->Fill(1.372);
  h_pb->Fill(1.374);
  h_pb->Fill(1.380);
  h_pb->Fill(1.381);
  h_pb->Fill(1.382);
  h_pb->Fill(1.385);
  h_pb->Fill(1.395);
  h_pb->Fill(1.402);
  h_pb->Fill(1.402);
  h_pb->Fill(1.405);
  h_pb->Fill(1.408);
  h_pb->Fill(1.408);
  h_pb->Fill(1.415);
  h_pb->Fill(1.416);
  h_pb->Fill(1.418);
  h_pb->Fill(1.419);
  h_pb->Fill(1.421);
  h_pb->Fill(1.425);
  h_pb->Fill(1.425);
  h_pb->Fill(1.425);
  h_pb->Fill(1.425);
  h_pb->Fill(1.428);
  h_pb->Fill(1.429);
  h_pb->Fill(1.430);
  h_pb->Fill(1.431);
  h_pb->Fill(1.432);
  h_pb->Fill(1.438);
  h_pb->Fill(1.438);
  h_pb->Fill(1.447);
  h_pb->Fill(1.450);
  h_pb->Fill(1.453);
  h_pb->Fill(1.460);
  h_pb->Fill(1.464);
  h_pb->Fill(1.475);
  h_pb->Fill(1.479);
  h_pb->Fill(1.482);
  h_pb->Fill(1.482);
  h_pb->Fill(1.487);
  h_pb->Fill(1.491);
  h_pb->Fill(1.492);
  h_pb->Fill(1.492);
  h_pb->Fill(1.492);
  h_pb->Fill(1.498);
  h_pb->Fill(1.499);
  h_pb->Fill(1.502);
  h_pb->Fill(1.509);
  h_pb->Fill(1.512);
  h_pb->Fill(1.514);
  h_pb->Fill(1.516);
  h_pb->Fill(1.519);
  h_pb->Fill(1.519);
  h_pb->Fill(1.522);
  h_pb->Fill(1.523);
  h_pb->Fill(1.526);
  h_pb->Fill(1.530);
  h_pb->Fill(1.530);
  h_pb->Fill(1.556);
  h_pb->Fill(1.582);
  h_pb->Fill(1.585);
  h_pb->Fill(1.587);
  h_pb->Fill(1.598);
  h_pb->Fill(1.605);
  h_pb->Fill(1.609);
  h_pb->Fill(1.617);
  h_pb->Fill(1.618);
  h_pb->Fill(1.638);
  h_pb->Fill(1.641);
  h_pb->Fill(1.690);
  h_pb->Fill(1.717); 

  h_p->SetLineColor(kRed);
  h_pb->SetLineColor(kBlue);
  h_p->SetLineWidth(2);
  h_pb->SetLineWidth(2);

  double max = TMath::Max(h_p->GetMaximum(),h_pb->GetMaximum()) * 1.1;
  h_p->GetYaxis()->SetRangeUser(0,max);

  TCanvas* c3 = new TCanvas;
  TLegend* leg3 = new TLegend(0.7,0.75,0.9,0.9);
  leg3->AddEntry(h_p,"proton","l");
  leg3->AddEntry(h_pb,"lead","l");
#ifdef __CINT__
  SetLegAtt(leg3);
#endif
  
  h_p->Draw();
  h_pb->Draw("SAME");
  leg3->Draw("SAME");
  c3->SaveAs((string("plots/vdm_beambeam_2.pdf")).c_str());

}
